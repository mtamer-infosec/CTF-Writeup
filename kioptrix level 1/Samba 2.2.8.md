# تقرير اختراق تدريبي — Kioptrix Level 1 (Samba 2.2.8)

**الكاتب:** Mohamed Tamer بمساعده الذكاء الاصطناعي chatgpt  
**تاريخ:** 2025-09-22  
**الهدف:** 192.168.244.136  
**بيئة الاختبار:** Kioptrix Level 1 (VM — بيئة تدريبية مرخَّصة)  
**ملاحظة قانونية:** جميع الأنشطة في هذا المستند تمت داخل بيئة اختبارية مرخَّصة. لا تستخدم أي شيفرة استغلالية على أنظمة لا تملك إذنًا صريحًا لاختبارها.

---

## 1 — ملخص تنفيذي
خلال اختبار أمني ضمن بيئة Kioptrix Level 1 تم اكتشاف ضعف مرتبط بخدمة Samba (النسخة: `samba-2.2.8`) على الهدف `192.168.244.136`، مما مكّن من الوصول بصلاحيات الجذر (`root`). هذا التقرير يوثق خطوات الاستطلاع، التحقق، الأثر، وتوصيات التصحيح بأسلوب احترافي مناسب للعرض في ملف بورتفوليو.

---

## 2 — نطاق الاختبار
- **العنوان المستهدف:** `192.168.244.136`  
- **الخدمات المستهدفة:** Samba (SMB)  
- **الأدوات المستخدمة:** `nmap`, `msfconsole` (كمثال)، أدوات تجميع مثل `gcc` للاختبارات المحلية في بيئة التدريب.  
- **ملاحظات:** لا يتضمن التقرير أي شيفرة استغلالية تنفيذية. أي مواد حساسة يجب أن تُخزَّن في ريبوزيتوري خاص.

---

## 3 — منهجية الاختبار (Commands & Results)
### فحص اكتشاف المضيف
```
nmap -sn 192.168.244.136
```
*نتيجة:* المضيف حيّ واستجاب.

### فحص نظام التشغيل
```
nmap -O 192.168.244.136
```
*نتيجة:* كشف تقريبي لنواة Linux (2.4.x).

### فحص الخدمات والنسخ
```
nmap -sV 192.168.244.136
```
*نتيجة:* خدمة Samba تعمل ونسختها قديمة.

### فحص شامل مع سكربتات
```
nmap -sC -sV -p- 192.168.244.136 --version-all --reason
```
*نتيجة:* تفاصيل إضافية عن الخدمات وسلوكها.

### مسح SMB عبر Metasploit (مثال)
```
msfconsole
use auxiliary/scanner/smb/smb_version
set RHOSTS 192.168.244.136
run
```
*نتيجة:* تأكيد أن النسخة هي `samba-2.2.8`.

### مخرجات موثقة (Proof)
المحتوى الذي زوَّدتني به يتضمن هذه المخرجات:
```
samba-2.2.8 < remote root exploit by eSDee (www.netric.org|be)
... Worked!
Linux kioptrix.level1 2.4.7-10 #1 ...
uid=0(root) gid=0(root) groups=99(nobody)
```
هذه المخرجات تثبت حصول وصول بصلاحيات `root` في بيئة الاختبار.

---

## 4 — وصف الثغرة (Technical summary)
- **السبب الجذري:** نسخة Samba قديمة وقابلة للاستغلال (2.2.8) تحتوي على ثغرات تُتيح تنفيذ أوامر عن بُعد أو تجاوز صلاحيات.  
- **متطلبات الاستغلال:** وصول شبكي إلى خدمة SMB (عادةً منفذ 445).  
- **التأثير:** تنفيذ أوامر عن بُعد → إمكانية الوصول بصلاحيات root.

---

## 5 — أثر الثغرة
- وصول تام لصلاحيات الجذر على النظام.  
- إمكانية سرقة بيانات، التعديل على النظام، إنشاء بوابات خلفية، أو الانتشار داخل الشبكة.

---

## 6 — توصيات التصحيح (Remediation)
1. **الترقية الفورية:** حدّث Samba إلى أحدث إصدار مدعوم.  
2. **تقييد الوصول:** استخدم جدار ناري لتقييد منافذ SMB (137-139, 445) للعناوين المصرح بها فقط.  
3. **تقليل الامتيازات:** شغّل خدمات الشبكة بأقل امتياز ممكن.  
4. **التدقيق والمراقبة:** فعّل سجلات مفصّلة ومراقبة IDS/IPS لأنشطة SMB.  
5. **سياسة تحديثات:** تنفيذ سياسة تصحيح دورية ومسح دوري للأنظمة القديمة.  
6. **حماية المستودعات:** لا ترفع شيفرات استغلالية أو ملفات تنفيذية إلى ريبوزيتوري عام.

---

## 7 — خطة استجابة فورية بعد الاستغلال
- عزل الجهاز عن الشبكة.  
- التقاط الأدلة (logs, disk image) في بيئة آمنة للـ forensics.  
- إعادة بناء النظام أو تنظيفه بعد التحقق من عدم وجود persistence.  
- إعلام فريق الأمن/IT إن كانت البيئة إنتاجية.

---

## 8 — ملاحق وأدلة (مصفّاة)
**ملفات مقترحة للتخزين الآمن داخل الريبو الخاص:**
- `scans/full_nmap_scan.txt` — نتائج Nmap (مصفّاة).  
- `evidence/shell_output.txt` — مقتطفات مخرجات shell (مصفّاة مثل `uid=0(root)`).  
- `notes/steps.md` — خطوات البحث والتحقق بدون شيفرة استغلال.

---

## 9 — نصائح لعرض المشروع في بورتفوليو
1. ضع الريبو **خاصًا** إذا احتوى على أي أدلة أو ملفات تنفيذية.  
2. أدرج نسخة مصفّاة عامة تشرح المشكلة والخطوات والصور مع طمس البيانات الحساسة.  
3. أرفق `report.md` و`report.pdf` (إن أمكن) لتسهيل قراءة جهات التوظيف.  
4. اذكر بوضوح أن العمل تم في بيئة مختبرية مرخَّصة وأنك تحافظ على أخلاقيات الأمن.

---

**انتهى التقرير.**  
إذا أردت، أستطيع أيضًا توليد نسخة PDF من هذا الملف هنا أو إنشاء README جاهز للـ GitHub — أخبرني أي واحد تريده وسأدرجه في الأرشيف الذي سأقدمه للتحميل.
